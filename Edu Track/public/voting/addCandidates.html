<!DOCTYPE html>
<html>
<head>
  <title>Add Candidates</title>
  <link rel="stylesheet" href="addCandidates.css">

</head>
<body>
  <h2>Create Session</h2>
  <input type="text" id="sessionTitle" placeholder="Session Title">
  <button onclick="createSession()">Create</button>

  <h2>Add Candidate</h2>
  <select id="sessionSelect"></select>
  <input type="text" id="candidateName" placeholder="Candidate Name">
  <button onclick="addCandidate()">Add Candidate</button>

  <h3 id="status"></h3>

  <script>
    async function fetchSessions() {
      const res = await fetch('/api/vote/sessions');
      const sessions = await res.json();
      const select = document.getElementById('sessionSelect');
      select.innerHTML = '';
      sessions.forEach(s => {
        const opt = document.createElement('option');
        opt.value = s.id;
        opt.textContent = s.title;
        select.appendChild(opt);
      });
    }

    async function createSession() {
      const title = document.getElementById('sessionTitle').value;
      const res = await fetch('/api/vote/create-session', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title })
      });
      const data = await res.json();
      document.getElementById('status').innerText = data.message;
      fetchSessions();
    }

    async function addCandidate() {
      const name = document.getElementById('candidateName').value;
      const sessionId = document.getElementById('sessionSelect').value;
      const res = await fetch('/api/vote/add-candidate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ sessionId, name })
      });
      const data = await res.json();
      document.getElementById('status').innerText = data.message;
    }

    fetchSessions();
  </script>
</body>
</html>
